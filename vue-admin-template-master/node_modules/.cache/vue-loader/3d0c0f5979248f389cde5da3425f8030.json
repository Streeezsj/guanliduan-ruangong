{"remainingRequest":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\vue管理端\\软件工程\\vue-admin-template-master\\src\\views\\login\\index.vue?vue&type=style&index=0&id=37dfd6fc&scoped=true&lang=css&","dependencies":[{"path":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\src\\views\\login\\index.vue","mtime":1655037082455},{"path":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\vue管理端\\软件工程\\vue-admin-template-master\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLm1haW5zIHsKICBiYWNrZ3JvdW5kOiB1cmwofkAvYXNzZXRzL2xvZ2luLmpwZyk7CiAgYmFja2dyb3VuZC1zaXplOiAxMDAlIDEwMCU7Cn0KLmxvZ2luX2JveCB7CiAgd2lkdGg6IDQ1MHB4OwogIGhlaWdodDogNDkwcHg7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKICBib3JkZXItcmFkaXVzOiAxOHB4OwogIHBhZGRpbmc6IDMwcHggNTBweCAzMHB4IDMwcHg7Cn0KLmxvZ2luX3RpdGxlIHsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgbWFyZ2luOiAzMHB4IDMwcHggNDBweCAzMHB4OwogIGZvbnQtc2l6ZTogMjRweDsKICBjb2xvcjogIzY2NjsKfQoubG9naW5fdGl0bGUgc3BhbiB7CiAgbWFyZ2luOiAwIDIwcHggMCAyMHB4OwogIGN1cnNvcjogcG9pbnRlcjsKfQoubG9naW5fdGl0bGUgc3Bhbjpob3ZlciB7CiAgY29sb3I6ICMzMzM7CiAgZm9udC13ZWlnaHQ6IGJvbGRlcjsKfQouaXNBY3RpdmVUaXRsZSB7CiAgY29sb3I6ICMzMzM7CiAgZm9udC13ZWlnaHQ6IGJvbGRlcjsKfQoubG9naW5fYWdyZWUgewogIG1hcmdpbi1sZWZ0OiAzMHB4Owp9Ci5sb2dpbl9idG4gewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogNTBweDsKICBtYXJnaW46IDAgMCAwIDEwcHg7CiAgYmFja2dyb3VuZC1jb2xvcjogIzBjYjk1ZjsKICBjb2xvcjogI2ZmZjsKfQouc2hvdy1wd2QgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICByaWdodDogMTBweDsKICB0b3A6IDVweDsKICBmb250LXNpemU6IDE2cHg7CiAgY3Vyc29yOiBwb2ludGVyOwogIHVzZXItc2VsZWN0OiBub25lOwp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n  <div class=\"mains\">\n    <div style=\"min-height: 950px; padding: 100px 0 0 640px\">\n      <div class=\"login_box\">\n        <p class=\"login_title\">\n          <span\n            :class=\"isActiveIndex === 0 ? 'isActiveTitle' : ''\"\n            @click=\"accountLogin\"\n            >账号登录</span\n          ><!-- 利用三元运算符判定点击了哪个登录,从而绑定样式 -->\n          <span\n            :class=\"isActiveIndex === 1 ? 'isActiveTitle' : ''\"\n            @click=\"smsLogin\"\n            >短信登录</span\n          >\n        </p>\n        <el-form\n          v-if=\"isActive\"\n          ref=\"loginForm\"\n          :rules=\"loginRules\"\n          :model=\"loginForm\"\n          label-width=\"80px\"\n        >\n          <el-form-item label=\"账号：\" prop=\"username\">\n            <el-input\n              ref=\"username\"\n              v-model=\"loginForm.username\"\n              placeholder=\"Username\"\n              name=\"username\"\n              type=\"text\"\n            />\n          </el-form-item>\n          <el-form-item label=\"密码：\" prop=\"password\">\n            <el-input\n              :key=\"passwordType\"\n              ref=\"password\"\n              v-model=\"loginForm.password\"\n              :type=\"passwordType\"\n              placeholder=\"Password\"\n              name=\"password\"\n              @keyup.enter.native=\"handleLogin\"\n            />\n            <span class=\"show-pwd\" @click=\"showPwd\">\n              <svg-icon\n                :icon-class=\"passwordType === 'password' ? 'eye' : 'eye-open'\"\n              />\n            </span>\n          </el-form-item>\n\n          <el-form-item prop=\"type\" style=\"margin-left: -50px\">\n            <el-checkbox\n              label=\"我已阅读并同意《用户服务协议》、《隐私权政策》\"\n              name=\"type\"\n              v-model=\"loginForm.type\"\n            ></el-checkbox>\n          </el-form-item>\n\n          <el-button\n            class=\"login_btn\"\n            :loading=\"loading\"\n            @click.native.prevent=\"handleLogin\"\n            >立 即 登 录</el-button\n          >\n          <!-- <p style=\"text-align: right; margin-top: 10px\"><a>忘记密码？</a></p> -->\n          <!-- <p style=\"text-align: center; margin-top: 40px\">\n            第三方登录或<a>立即注册</a>\n          </p> -->\n        </el-form>\n        <!-- 用手机，验证码登录 -->\n        <el-form\n          v-else\n          ref=\"loginForm2\"\n          :model=\"loginForm2\"\n          label-width=\"80px\"\n          :rules=\"loginRules2\"\n        >\n          <el-form-item label=\"手机号：\" prop=\"phone\">\n            <el-input\n              ref=\"phone\"\n              v-model=\"loginForm2.phone\"\n              placeholder=\"请输入手机号\"\n              name=\"phone\"\n              type=\"text\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item label=\"验证码：\" prop=\"code\">\n            <el-input\n            ref=\"code\"\n              v-model=\"loginForm2.code\"\n              style=\"width: 60%\"\n              placeholder=\"请输入验证码\"\n              name=\"code\"\n              @keyup.enter.native=\"handleLogin2\"\n              maxlength=\"6\"\n            ></el-input>\n            <el-button @click.native.prevent=\"handleCode\">获取验证码</el-button>\n          </el-form-item>\n          <el-form-item prop=\"type\" style=\"margin-left: -50px\">\n            <el-checkbox\n              label=\"我已阅读并同意《用户服务协议》、《隐私权政策》\"\n              name=\"type\"\n              v-model=\"loginForm2.type\"\n            ></el-checkbox>\n          </el-form-item>\n          <el-button\n            class=\"login_btn\"\n            :loading=\"loading\"\n            @click.native.prevent=\"handleLogin2\"\n            >立 即 登 录</el-button\n          >\n          <p style=\"text-align: right; margin-top: 10px\"><a>忘记密码？</a></p>\n          <p style=\"text-align: center; margin-top: 40px\">\n            第三方登录或<a>立即注册</a>\n          </p>\n        </el-form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport codes from \"@/api/msm\";\nexport default {\n  name: \"Login\",\n  data() {\n    const validateUsername = (rule, value, callback) => {\n      console.warn(\"aaa\", value);\n      if (!value) {\n        return callback(new Error(\"用户名不能为空\"));\n      }\n      setTimeout(() => {\n        if (value ===value) {\n          callback();\n        } else {\n          callback(new Error(\"用户名输入错误\"));\n        }\n      }, 1000);\n    };\n    const validatePassword = (rule, value, callback) => {\n\n      if (!value) {\n        return callback(new Error(\"密码不能为空\"));\n      }\n      setTimeout(() => {\n        if (value ===value) {\n          callback();\n          console.warn(\"qqq\", value);\n        } else {\n          callback(new Error(\"密码输入错误\"));\n        }\n      }, 1000);\n    };\n    const vaildatePhone = (rule,value,callback) =>{\n\n        const reg = /^1[34578]\\d{9}$/\n      if (!value) {\n        return callback(new Error(\"手机号不能为空\"));\n      }\n       setTimeout(() => {\n        if (value === value) {\n          callback();\n          console.warn(\"ccc\", value);\n        } else {\n          callback(new Error(\"输入手机格式不正确\"));\n          console.log(value);\n          console.log('asdsdasd',this.loginForm2.phone);\n        }\n      }, 1000);\n\n    };\n    const vaildateCode =(rule,value,callback) =>{\n\n      if (!value) {\n        return callback(new Error(\"验证码不能为空\"));\n      }\n      setTimeout(() => {\n        if (value === value) {\n          callback();\n          console.warn(\"abc\", value);\n        } else {\n          callback(new Error(\"验证码错误\"));\n        }\n      }, 1000);\n    };\n    return {\n      isActive: true, // 用于实现切换登录，作为判断\n      isActiveIndex: 0,\n      loginForm: {\n        username: \"\",\n        password: \"\",\n      },\n      loginForm2: {\n        phone: \"\",\n        code: \"\",\n      },\n      loginRules: {\n        username: [{ validator: validateUsername, trigger: \"blur\" }],\n        password: [{ validator: validatePassword, trigger: \"blur\" }],\n        type: [\n          { required: true, message: \"请✔勾选上用户协议\", trigger: \"blur\" },\n        ],\n      },\n      loginRules2: {\n        phone:[{validator: vaildatePhone, trigger: \"blur\"}],\n        code:[{\n            validator: vaildateCode,\n            trigger: \"blur\"\n}],\ntype: [\n          { required: true, message: \"请✔勾选上用户协议\", trigger: \"blur\" },\n        ],\n      },\n      loading: false,\n      passwordType: \"password\",\n      redirect: undefined,\n    };\n  },\n  //页面加载调用获取cookie值\n  mounted() {\n    this.getCookie();\n  },\n  watch: {\n    $route: {\n      handler: function (route) {\n        this.redirect = route.query && route.query.redirect;\n      },\n      immediate: true,\n    },\n  },\n  methods: {\n    clearValidate(formName) {\n      this.$refs[formName].clearValidate();\n  },\n    showPwd() {\n      if (this.passwordType === \"password\") {\n        this.passwordType = \"\";\n      } else {\n        this.passwordType = \"password\";\n      }\n\n    },\n    accountLogin() {\n      // 账号登录\n      this.isActive = true;\n      this.isActiveIndex = 0;\n      this.clearValidate('loginForm2')\n\n    },\n    handleLogin() {\n      this.$refs.loginForm.validate((valid) => {\n        if (valid) {\n          this.loading = true;\n          this.$store\n            .dispatch(\"user/login\", this.loginForm)\n            .then((resp) => {\n              this.$router.push({\n                path: this.redirect || \"/\",\n                query: this.otherQuery,\n              });\n              this.$message({\n                message: \"登录成功!\",\n                type: \"success\",\n              });\n              this.loading = false;\n              // let token = resp.data;\n\n\n              // sessionStorage.setItem(\"token\",token)\n              console.log('123123123123',window.sessionStorage.getItem('token'))\n              // console.log('123123123123',window.sessionStorage.setItem('token'))\n            })\n            .catch(() => {\n              this.loading = false;\n              this.$message({\n                message: \"用户名或密码错误!\",\n                type: \"error\",\n              });\n            });\n          //   var token = 'asdasdasd';\n          // window.sessionStorage.removeItem('token',token)\n          // console.log('ttt',window.sessionStorage.getItem('token'))\n        } else {\n          console.log(\"error submit!!\");\n          this.$message.error(\"用户名或密码填写错误！\");\n          return false;\n        }\n      });\n    },\n    handleLogin2() {\n        this.$refs.loginForm2.validate((valid) =>{\n          if(valid){\n            console.log(\"zsj\");\n            this.loading = true;\n\n      this.$store.dispatch(\"user/loginphone\", this.loginForm2).then(() => {\n        console.log(\"zsjnb\");\n        this.$router.push({\n          path: this.redirect || \"/\",\n          query: this.otherQuery,\n        });\n        this.$message({\n          message: \"登录成功!\",\n          type: \"success\",\n        });\n        this.loading = false;\n      })\n       .catch(() => {\n              this.loading = false;\n              this.$message({\n                message: \"手机号或验证码输入错误!\",\n                type: \"error\",\n              });\n            });\n        } else {\n          console.log(\"why!\");\n          // this.$message.error(\"用户名或密码填写错误！\");\n          return false;\n\n          }\n        })\n    },\n\n    handleCode() {\n       if (!(/^1[34578]\\d{9}$/.test(this.loginForm2.phone))) {\n        this.$message.error('手机号码或者格式不正确')\n        return;\n      }\n      var vm = this;\n      this.phone = this.loginForm2.phone\n      console.log(this.phone);\n      codes\n        .sendCode(this.phone)\n        //请求成功调用\n        .then(function (res) {\n          console.log(\"zsjzsj\");\n          console.log(\"qqqqqqqqqqqq\", res.code);\n        })\n        .catch(() => {\n              this.loading = false;\n              this.$message({\n                message: \"该手机账号不存在!\",\n                type: \"error\",\n              });\n            });\n\n    },\n    smsLogin() {\n      // 短信登录\n      this.isActive = false;\n      this.isActiveIndex = 1;\n      this.clearValidate('loginForm')\n    },\n  },\n};\n</script>\n\n<style scoped>\n.mains {\n  background: url(~@/assets/login.jpg);\n  background-size: 100% 100%;\n}\n.login_box {\n  width: 450px;\n  height: 490px;\n  background-color: #fff;\n  border-radius: 18px;\n  padding: 30px 50px 30px 30px;\n}\n.login_title {\n  text-align: center;\n  margin: 30px 30px 40px 30px;\n  font-size: 24px;\n  color: #666;\n}\n.login_title span {\n  margin: 0 20px 0 20px;\n  cursor: pointer;\n}\n.login_title span:hover {\n  color: #333;\n  font-weight: bolder;\n}\n.isActiveTitle {\n  color: #333;\n  font-weight: bolder;\n}\n.login_agree {\n  margin-left: 30px;\n}\n.login_btn {\n  width: 100%;\n  height: 50px;\n  margin: 0 0 0 10px;\n  background-color: #0cb95f;\n  color: #fff;\n}\n.show-pwd {\n  position: absolute;\n  right: 10px;\n  top: 5px;\n  font-size: 16px;\n  cursor: pointer;\n  user-select: none;\n}\n</style>\n"]}]}